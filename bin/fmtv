#!/usr/bin/env ruby

lib = File.expand_path('../../lib', __FILE__)
$LOAD_PATH.unshift(lib) unless $LOAD_PATH.include?(lib)

require 'followmytv'
include Followmytv::API


RestClient.log = 'stdout'



def login(username, password)
  begin
    form_post('login', '#UserLoginForm', {'data[User][email]' => username, 'data[User][password]' => password})
  rescue RestClient::Found
  end
end







puts '-------------------------- Episodes -------------------------------'

ajax_get('users/episode_list')['items'].each do |item|
  show = Followmytv::Show.from_json(item.delete('Show'))
  episode = Followmytv::Episode.from_json(item.delete('Episode'))

  p show
  p episode
  puts ''
end

puts '-------------------------- Shows -------------------------------'

ajax_get('users/show_list')['items'].each do |item|
  show = Followmytv::Show.from_json(item.delete('Show'))

  p show
end


puts '-------------------------- Shows Search -------------------------------'

puts ajax_post('shows/search.json', 'data[Show][showName]' => 'Atlantis')
